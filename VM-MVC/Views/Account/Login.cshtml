<div>
    <script type="application/x-javascript">
        addEventListener("load", function() { setTimeout(hideURLbar, 0); }, false);
               function hideURLbar(){ window.scrollTo(0,1); } </script>
    <script src="http://passport.cnblogs.com/scripts/jsencrypt.min.js"></script>
    <!-- //custom-theme -->
    <!-- Google fonts -->
    <link href="http://fonts.googleapis.com/css?family=Open+Sans:300,300i,400,400i,600,600i,700,700i,800,800i&amp;subset=cyrillic,cyrillic-ext,greek,greek-ext,latin-ext,vietnamese" rel="stylesheet">
    <link href="http://fonts.googleapis.com/css?family=Raleway:100,100i,200,200i,300,300i,400,400i,500,500i,600,600i,700,700i,800,800i,900,900i&amp;subset=latin-ext" rel="stylesheet">
    <!-- Google fonts -->
    <!-- css files -->
    <link href="~/Content/style.css" type="text/css" rel="stylesheet" media="all">
    <!-- //css files -->

    <link rel="stylesheet" href="~/Content/font-awesome.css"> <!-- Font-Awesome-Icons-CSS -->

    <link href="~/Content/popup-box.css" rel="stylesheet" type="text/css" media="all" /> <!-- popup box css -->


    <div class="register">
        <div class="register-right">
            <div class="register-in">
                <a class="book popup-with-zoom-anim button-isi zoomIn animated" data-wow-delay=".5s" href="#small-dialog2">register here »</a>
            </div>
            <div class="register-in">
                <a class="book popup-with-zoom-anim button-isi zoomIn animated" data-wow-delay=".5s" href="#small-dialog">login here »</a>
            </div>
        </div>
    </div>



    <!-- login form popup-->
    <div class="pop-up">
        <div id="small-dialog" class="mfp-hide book-form">

            <div class="login-form login-form-left">
                <div class="agile-row">
                    <h3>Login to your site</h3>
                    <span class="fa fa-lock"></span>
                    <div class="clear"></div>
                    <div class="login-agileits-top">
                        @*<form action="@Url.RouteUrl("Authenticate")" method="post">*@
                        <input type="text" id="userName" class="name" name="username" Placeholder="Username" required="" />
                        <input type="password" id="password" class="password" name="Password" Placeholder="Password" required="" />
                        <input type="submit" id="btnAuthenticate" value="Login">
                        @*</form>*@
                    </div>
                    <div class="login-agileits-bottom">
                        <h6><a href="#">Forgot password?</a></h6>
                    </div>
                </div>
            </div>

        </div>
    </div>
    <div class="pop-up">
        <div id="small-dialog2" class="mfp-hide book-form">

            <div class="login-form login-form-left">
                <div class="agile-row">
                    <h3>Register form</h3>
                    <div class="login-agileits-top">
                        @*<form action="@Url.RouteUrl("Register")" method="post">*@
                        <input type="text" class="name" id="regUserName" name="userName" Placeholder="Full Name" required="" />
                        <input type="email" class="email" name="email" Placeholder="Email" required="" />
                        <input type="text" class="phone" name="phone" Placeholder="Phone Number" required="" />
                        <input type="password" class="password" id="regPassword" name="password" Placeholder="Password" required="" />
                        <div class="login-check">
                            <label class="checkbox"><input type="checkbox" name="checkbox" checked=""><i> </i> I Accept to the <a href="#">Terms &amp; Conditions</a></label>
                        </div>
                        <input type="submit" value="Register" id="btnRegister">
                        @*</form>*@
                    </div>
                </div>
            </div>

        </div>
    </div>
    <!-- //register form popup-->
    <!-- js -->
    <script type="text/javascript" src="~/Scripts/jquery-2.1.4.min.js"></script>
    <!-- //js -->
    <!--popup-js-->
    <script src="~/Scripts/jquery.magnific-popup.js" type="text/javascript"></script>
    <script type="text/javascript" src="Scripts/jquery.cookie.js"></script>
    <script>
        $(document).ready(
            function () {
                Init();
                InitLogin();
                InitRegister();
            }
        );
        function getPublicKey() {
            var pubKey = "";
            if ($.cookie('publicKey') == null) {
                $.ajax({
                    url: "@Url.RouteUrl("GetRSAPubKey")",
                    type: "GET",
                    contentType: "application/x-www-form-urlencoded; charset=utf-8",
                    async: false,
                    data: {},
                    dataType: "json",
                    success: function (data) {
                        if (data.Code == 0) {
                            pubKey = data.RsaPublicKey;
                            $.cookie('publicKey', pubKey, { expires: 1 / 1440 });
                        }
                        else {
                            Config.Method.JudgeCode(data, 1);
                        }
                    }
                })
            }
            else {
                pubKey = $.cookie('publicKey');
            }
            return pubKey;
        }

        function Init() {
            $('.popup-with-zoom-anim').magnificPopup({
                type: 'inline',
                fixedContentPos: false,
                fixedBgPos: true,
                overflowY: 'auto',
                closeBtnInside: true,
                preloader: false,
                midClick: true,
                removalDelay: 300,
                mainClass: 'my-mfp-zoom-in'
            });
        }

        function InitLogin() {
            $("#btnAuthenticate").click(function () {
                var publicKey = getPublicKey();
                var userName = Encrypt($("#userName")[0].value, publicKey);
                var passwd = Encrypt($("#password")[0].value, publicKey);

                $.ajax({
                    type: "POST",
                    url: "@Url.RouteUrl("Authenticate")",
                    data: {
                        userName: userName,
                        password: passwd,
                        key: publicKey
                    },
                    success: function (data) {
                        if (data.result == true) {
                            window.location.href = data.url;
                            return false;
                        }
                        else {
                            alert(data.message);
                        }
                    },
                    async: false,
                    error: function (XMLHttpRequest, textStatus, errorThrown) {
                        alert(XMLHttpRequest.status + '||' + XMLHttpRequest.readyState + '||' + textStatus);
                    }
                })
            });
        }

        function InitRegister() {
            $("#btnRegister").click(function () {
                var publicKey = getPublicKey();
                var userName = Encrypt($("#regUserName")[0].value, publicKey);
                var passwd = Encrypt($("#regPassword")[0].value, publicKey);

                $.ajax({
                    type: "POST",
                    url: "@Url.RouteUrl("Register")",
                    data: {
                        userName: userName,
                        password: passwd,
                        email: $(".email")[0].value,
                        phone: $(".phone")[0].value,
                        key: publicKey
                    },
                    success: function (data) {
                        if (data.result == true) {
                            window.location.href = data.url;
                            return false;
                        }
                        else {
                            alert(data.message);
                        }
                    },
                    async:false
                })
            });
        }

        function Encrypt(plaintText, publicKey) {
            var encrypt = new JSEncrypt();
            encrypt.setPublicKey(publicKey);
            return encrypt.encrypt(plaintText);
        }
    </script>
    <!--//popup-js-->
</div>